import{S as g,B as v}from"./BannerComponent-32be86f1.js";import{r,o as p,c as _,d as e,a,w as f,t as h,I as B,J as S,E as D,a6 as b,a7 as V,a8 as x,a9 as C,aa as F,ab as I,a5 as E,B as k,C as L,_ as w,ac as y,L as U,F as N}from"./index-edfc45b8.js";import"./page-title-bg-196c08fc.js";const P={class:"container my-10 lg:my-20"},H={class:"grid lg:grid-cols-12 lg:gap-6"},M={class:"flex gap-3"},Y={class:"flex-1"},z=e("label",{for:"name",class:"block w-full"},"姓名",-1),O={class:"mx-auto block w-fit text-orange-pink"},R={class:"flex-1"},A=e("label",{for:"tel",class:"block w-full"},"電話",-1),W={class:"mx-auto block w-fit text-orange-pink"},j=e("label",{for:"date",class:"block"},"賞車時間",-1),q=["value"],J={key:0,class:"mx-auto block w-fit text-orange-pink"},G={class:"flex flex-col"},K=e("label",{for:"tel"},"車款",-1),Q=["value"],X=["src"],Z={class:"flex gap-3"},tt=e("button",{class:"btn-primary btn flex-1"},"確認",-1);function et(t,o,d,m,s,l){const n=r("v-field"),i=r("v-date-picker"),$=r("v-form");return p(),_("section",P,[e("div",H,[a($,{class:"grid gap-4 lg:col-span-4 lg:col-start-5",onSubmit:l.onSubmit,"validation-schema":s.orderSchema},{default:f(u=>[e("div",M,[e("div",Y,[z,a(n,{id:"name",type:"text",label:"姓名",name:"name",class:"input w-full text-smoke-dark lg:mt-2"}),e("span",O,h(u.errors.name),1)]),e("div",R,[A,a(n,{id:"tel",type:"tel",name:"tel",class:"input w-full text-smoke-dark lg:mt-2"}),e("span",W,h(u.errors.tel),1)])]),a(i,{"min-date":new Date,modelValue:s.date,"onUpdate:modelValue":o[0]||(o[0]=c=>s.date=c),mode:"dateTime",masks:s.masks,is24hr:""},{default:f(({inputValue:c,inputEvents:T})=>[j,e("input",B({id:"date",class:"h-12 w-full rounded-lg border bg-light-white px-2 py-1 text-smoke-dark",value:c},S(T,!0),{name:"date"}),null,16,q),s.date.getTime()<=new Date().getTime()+72e5?(p(),_("span",J,h(u.errors.date),1)):D("",!0)]),_:2},1032,["min-date","modelValue","masks"]),e("div",G,[K,e("input",{id:"tel",type:"tel",value:`${t.bike.year} ${t.bike.model}`,class:"input disabled:bg-light-white disabled:text-dark-gray lg:mt-2",disabled:""},null,8,Q)]),e("div",null,[e("img",{src:t.bike.imgUrl,class:"mx-auto"},null,8,X)]),e("div",Z,[e("button",{type:"button",class:"btn-outline btn-primary btn flex-1 bg-light-white text-light-purple",onClick:o[1]||(o[1]=c=>t.$router.push("/shop/"))}," 取消 "),tt])]),_:1},8,["onSubmit","validation-schema"])])])}Object.keys(b).forEach(t=>{V(t,b[t])});x({tw:y});C({generateMessage:x("zh_TW",y)});const ot={components:{VForm:F,VField:I},data(){const t=E.mixin({toast:!0,position:"top-right",iconColor:"white",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:1500,timerProgressBar:!0});return{orderSchema:{name:"required",tel:this.isPhone,date:this.isDate},date:new Date,masks:{inputDateTime24hr:"YYYY/MM/DD HH:mm"},toast:t}},computed:{...k(g,["bike","VITE_URL"]),...k(U,["user","isLoggedIn"]),todayTimestamp(){return new Date().getTime()},bookDate(){return new Intl.DateTimeFormat("zh-TW",{dateStyle:"long",timeStyle:"short"}).format(this.date)}},methods:{...L(g,["getBike"]),isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:typeof t!="number"&&t?"請輸入正確格式，例如：09xx-xxx-xxx":"電話號碼 為必填"},isDate(){return this.date<=this.todayTimestamp+72e5?"預約賞車時間必須大於 2 小時以後":!0},addBooking(t,o,d,m){const s="ordersBook",l=`${this.VITE_URL}/${s}`,n={userId:t,name:o,phone:d,bike_year:this.bike.year,bike:m,date_take_a_look:this.date.getTime()};this.$http.post(l,n).then(()=>{this.toast.fire({icon:"success",title:"即將回到重機商城頁面"}).then(()=>{this.$router.push("/shop/")})}).catch(i=>{console.log(i)})},checkUser(){this.isLoggedIn||this.$swal({title:"請登入後繼續",icon:"error",confirmButtonText:"確定"}).then(()=>{this.$router.push("/shop/")})},onSubmit(t){this.$swal({icon:"warning",title:"請確認基本資訊",html:`
        姓名: ${t.name}<br />
        電話: ${t.tel}<br />
        賞車時間: ${this.bookDate}<br />
        車款: ${this.bike.model}`,showDenyButton:!0,confirmButtonText:"確認",denyButtonText:"取消",reverseButtons:!0}).then(o=>{o.isConfirmed&&this.addBooking(this.user.id,t.name,t.tel,this.bike.model)})}},mounted(){this.getBike(this.$route.params.id),this.checkUser()}},st=w(ot,[["render",et]]);function nt(t,o,d,m,s,l){const n=r("banner-component"),i=r("order-component");return p(),_(N,null,[a(n),a(i)],64)}const at={components:{OrderComponent:st,BannerComponent:v}},ct=w(at,[["render",nt]]);export{ct as default};
